<?xml version="1.0" encoding="utf-8"?>
<RibbonDiffXml>
	<CustomActions>
		<!-- Global ribbon commands -->
		<CustomAction Id="Microsoft.Dynamics.Service.CIFramework.Presence" Location="Mscrm.GlobalTab.New.Controls._children">
			<CommandUIDefinition>
				<Button
					Id="Microsoft.Dynamics.Service.CIFramework.Presence.Dialog"
					Command="Microsoft.Dynamics.Service.CIFramework.Presence.DialogCommand"
					Sequence="6"
					LabelText="$LocLabels:msdyn.ApplicationRibbon.Presence.Button.LabelText"
					ToolTipTitle="$LocLabels:msdyn.ApplicationRibbon.Presence.Button.LabelText"
					TemplateAlias="o1"
					ModernImage="$webresource:/WebResources/msdyn_UnknownStatus.svg"
				/>
			</CommandUIDefinition>
		</CustomAction>
	</CustomActions>
	<CommandDefinitions>
		<CommandDefinition Id="Microsoft.Dynamics.Service.CIFramework.Presence.DialogCommand">
			<EnableRules>
				<EnableRule Id="Mscrm.ShowOnOCEngagementHub" />
			</EnableRules>
			<DisplayRules />
			<Actions>
				<JavaScriptFunction FunctionName="Microsoft.CIFramework.Internal.OpenPresenceDialogControl.Instance.openPresenceDialog" Library="$webresource:OpenDialogLib/msdyn_internal_openDialog_ci_library.js" />
			</Actions>
		</CommandDefinition>
	</CommandDefinitions>
	<RuleDefinitions>
		<TabDisplayRules />
		<DisplayRules />
	<EnableRules>
		<EnableRule Id="Mscrm.ShowOnOCEngagementHub">
			<CustomRule FunctionName="Microsoft.CIFramework.Internal.OpenPresenceDialogControl.Instance.addPresenceCommand" Library="$webresource:OpenDialogLib/msdyn_internal_openDialog_ci_library.js" />
		</EnableRule>
	</EnableRules>
	</RuleDefinitions>
	<LocLabels>
		<LocLabel Id="msdyn.ApplicationRibbon.Presence.Button.LabelText">
			<Titles>
				<Title description="Launch presence dialog" languagecode="1033" />
			</Titles>
		</LocLabel>
	</LocLabels>
</RibbonDiffXml>