<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <style>
        body,html,iframe{
            height:100%;
            width:100%;
        }
    </style>
    <meta>
    <meta>
    <meta>
</head>
<body>
    <iframe src="" id="externalUrlFrame"></iframe>
    <script type="text/javascript">
        document.onreadystatechange = function () {
            if (document.readyState == "complete") {
                updateSrc();
            }
        }
        function updateSrc() {
            var vals = new Array();
            if (location.search != "") {
                var searchstring = "cif_thirdpartyurl";
                var querystring = decodeURIComponent(location.search); // to remove encoding done from platform on webresource data if any
                var index = querystring.indexOf(searchstring);

                if (index == -1 && querystring.indexOf("url=") != -1) { // private preview bits generates the url with this string
                    searchstring = "url=";
                    index = querystring.indexOf(searchstring);
                }

                if (index >= 0)
                {
                    url = querystring.substring(index + searchstring.length, querystring.length);
                    url = decodeURIComponent(url); // and to remove encoding done from our plugin.
                   try {
                     var urlObj = new URL(url);
                    }
                    catch (err) {
                        if (top.Microsoft) {
                            var CIFInternal = top.Microsoft.CIFramework.Internal;
                            var err = CIFInternal.generateErrorObject({ message: "Incorrect third party URL to load" }, "msdyn_ExternalWebPageContainer initializer", CIFInternal.errorTypes.InvalidParams);
                            top.Xrm.Utility.getGlobalContext().getCurrentAppProperties().then((result) => {
                                CIFInternal.logAPIInternalInfo(result.appId, true, err, "LoadTabWithThirdPartyWebSite", "");
                            },
                            (err) => {
                                CIFInternal.logAPIInternalInfo("", true, err, "LoadTabWithThirdPartyWebSite", "");
                            })
                        }
                        console.log("Incorrect URL");
                        return;
                    }
                document.getElementById("externalUrlFrame").src = url;
            }
          }
        }
    </script>
</body>
</html>